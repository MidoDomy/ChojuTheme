{% sw_extends '@Storefront/storefront/base.html.twig' %}

{% block base_header %}
    {# Check if category has teaser image - start #}
    {% set currentCategory = page.header.navigation.active %}
    {% set isHomepage = true %}
    {% for navItem in page.header.navigation.tree %}
        {% if currentCategory.id == navItem.id %}
            {% set isHomepage = false %}
        {% endif %}
    {% endfor %}

    {% set hasTeaser = currentCategory.media ? true : false %}

    {% if isHomepage and not(controllerAction|lower == 'home') %}
        {% set hasTeaser = false %}
    {% endif %}
    {# Check if category has teaser image - end #}

    <header class="header-main{% if not(hasTeaser) %} header-dark{% endif %}{% if hasTeaser %} position-absolute{% endif %}">
        {% block base_header_inner %}
            <div class="container-fluid">
                {% sw_include '@Storefront/storefront/layout/header/header.html.twig' %}
            </div>
        {% endblock %}
    </header>
{% endblock %}

{% block base_navigation %}{% endblock %}

{% block base_offcanvas_navigation %}
    {# Removed offcanvas navigation - dropdown implemented in header #}

    {# Category teaser #}
    {# Check if category has teaser image - start #}
    {% set currentCategory = page.header.navigation.active %}
    {% set isHomepage = true %}
    {% for navItem in page.header.navigation.tree %}
        {% if currentCategory.id == navItem.id %}
            {% set isHomepage = false %}
        {% endif %}
    {% endfor %}

    {% set hasTeaser = currentCategory.media ? true : false %}

    {% if isHomepage and not(controllerAction|lower == 'home') %}
        {% set hasTeaser = false %}
    {% endif %}
    {# Check if it has teaser image - end #}
    
    {% if hasTeaser %}
        {% sw_include '@Storefront/storefront/component/custom/category-teaser.html.twig' with {
            category: currentCategory
        } %}
    {% endif %}

    {# Fixed global action buttons #}
    {% sw_include '@Storefront/storefront/component/custom/global-actions.html.twig' %}
{% endblock %}

{% block base_main_inner %}
    {% block base_main_container %}
        <div class="container-main">
            {% block base_breadcrumb %}
                {{ parent() }}
            {% endblock %}

            <div class="container">
                {% block base_content %}{% endblock %}
            </div>
        </div>
    {% endblock %}
{% endblock %}
